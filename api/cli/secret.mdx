---
title: secret Command
---

The `secret` command generates a cryptographically secure random secret for the `BETTER_AUTH_SECRET` environment variable.

## Usage

```bash
npx @better-auth/cli secret
```

## What It Does

The `secret` command:

1. Generates a 32-byte random hex string
2. Displays the secret in a format ready to add to your `.env` file
3. Provides instructions for using the secret

## Output

The command outputs:

```
Add the following to your .env file:
# Auth Secret
BETTER_AUTH_SECRET=a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6
```

## Why You Need a Secret

The `BETTER_AUTH_SECRET` is used for:

- **Session signing** - Cryptographically sign session tokens
- **Token generation** - Generate secure verification tokens
- **Cookie encryption** - Encrypt sensitive cookie data
- **CSRF protection** - Generate and verify CSRF tokens

<Callout type="warning">
Keep your secret secure! Never commit it to version control or share it publicly.
</Callout>

## Requirements

The secret should be:

- **At least 32 characters long** - For adequate security
- **Random** - Not predictable or based on other data
- **Unique per environment** - Different for dev, staging, and production
- **Kept secret** - Never exposed in client-side code

## Usage in Configuration

After generating, add the secret to your environment variables:

```env title=".env"
BETTER_AUTH_SECRET="a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6"
```

Then use it in your Better Auth configuration:

```ts title="auth.ts"
import { betterAuth } from "better-auth";

export const auth = betterAuth({
  secret: process.env.BETTER_AUTH_SECRET,
  // ... other config
});
```

## Examples

### Generate and Copy

```bash
# Generate secret
npx @better-auth/cli secret

# Copy the generated secret to .env
```

### Generate Multiple Secrets

For different environments:

```bash
# Development secret
npx @better-auth/cli secret
# Add to .env.development

# Staging secret
npx @better-auth/cli secret
# Add to .env.staging

# Production secret
npx @better-auth/cli secret
# Add to .env.production
```

## Environment Setup

### Development

```env title=".env.local"
BETTER_AUTH_SECRET="dev-secret-generated-here"
BETTER_AUTH_URL="http://localhost:3000"
```

### Production

```env title=".env.production"
BETTER_AUTH_SECRET="prod-secret-generated-here"
BETTER_AUTH_URL="https://example.com"
```

<Callout type="danger">
Never use the same secret in development and production!
</Callout>

## Security Best Practices

### DO:

- Generate a new secret for each environment
- Store secrets in environment variables
- Use different secrets for dev/staging/production
- Rotate secrets periodically
- Use a secrets manager in production (AWS Secrets Manager, HashiCorp Vault, etc.)

### DON'T:

- Hardcode secrets in your code
- Commit secrets to version control
- Share secrets in plain text (email, chat, etc.)
- Reuse secrets across projects
- Use predictable secrets like "secret123"

## Secrets Management

### Local Development

Use `.env.local` which is git-ignored:

```env title=".env.local"
BETTER_AUTH_SECRET="local-dev-secret"
```

### CI/CD

Set secrets in your CI/CD platform:

```yaml title=".github/workflows/deploy.yml"
env:
  BETTER_AUTH_SECRET: ${{ secrets.BETTER_AUTH_SECRET }}
```

### Production

Use your hosting platform's secrets management:

```bash
# Vercel
vercel env add BETTER_AUTH_SECRET

# Netlify
netlify env:set BETTER_AUTH_SECRET

# Railway
railway variables set BETTER_AUTH_SECRET=...
```

## Rotation

When rotating secrets:

1. **Generate new secret**:
   ```bash
   npx @better-auth/cli secret
   ```

2. **Update environment variables**:
   ```env
   BETTER_AUTH_SECRET="new-secret-here"
   ```

3. **Deploy updated config**

4. **Sessions created with old secret will expire naturally**

<Callout type="info">
Rotating secrets will invalidate all existing sessions. Users will need to sign in again.
</Callout>

## Alternative Methods

You can also generate secrets using:

### Node.js

```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

### OpenSSL

```bash
openssl rand -hex 32
```

### Online Tools

<Callout type="warning">
While convenient, generating secrets online is less secure. Use the CLI or local methods for production secrets.
</Callout>

## Troubleshooting

### Secret Not Set

If you see an error about missing secret:

```bash
# Generate one
npx @better-auth/cli secret

# Add to .env
echo 'BETTER_AUTH_SECRET="generated-secret"' >> .env
```

### Secret Too Short

If you manually set a secret that's too short:

```bash
# Generate a proper one
npx @better-auth/cli secret
```

The generated secret is always 64 characters (32 bytes in hex).

### Wrong Environment

If sessions work in dev but not production:

- Check that `BETTER_AUTH_SECRET` is set in production
- Verify it's different from your dev secret
- Ensure it's not committed to git

## See Also

- [init Command](/api/cli/init) - Initialize Better Auth
- [Configuration](/api/server/configuration) - Configuration options
- [Installation Guide](/installation) - Getting started
- [Environment Variables](/guides/configuration) - Configuration guide
