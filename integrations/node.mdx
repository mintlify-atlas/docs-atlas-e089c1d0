---
title: Node.js
description: Learn how to integrate Better Auth with Node.js frameworks
---

Better Auth provides the `toNodeHandler` helper to integrate with any Node.js HTTP framework that uses standard Node.js request/response objects.

## Installation

<Steps>

<Step>
### Install Better Auth

First, install Better Auth in your Node.js project:

```package-install
better-auth
```
</Step>

<Step>
### Configure Better Auth

Create your Better Auth instance. See the [installation guide](/docs/installation) for detailed configuration.

```ts title="auth.ts"
import { betterAuth } from "better-auth";

export const auth = betterAuth({
  database: {
    // your database configuration
  },
  // other options
});
```

<Callout>
**Note:** CommonJS (cjs) is not supported. Use ECMAScript Modules (ESM) by setting `"type": "module"` in your `package.json` or configuring your `tsconfig.json` for ES modules.
</Callout>
</Step>

<Step>
### Mount the Handler

Use `toNodeHandler` to convert the Better Auth handler to a Node.js-compatible handler:

<Tabs items={["express", "fastify", "hono", "raw-node"]}>
  <Tab value="express">
    ```ts title="server.ts"
    import express from "express";
    import { toNodeHandler } from "better-auth/node";
    import { auth } from "./auth";

    const app = express();
    const port = 3000;

    // Mount Better Auth handler
    app.all("/api/auth/*", toNodeHandler(auth));

    // Mount express.json() AFTER the auth handler
    app.use(express.json());

    app.listen(port, () => {
      console.log(`Server listening on port ${port}`);
    });
    ```

    <Callout type="warn">
    **Important:** Do not use `express.json()` before the Better Auth handler, or the client will get stuck on "pending". Apply it only to other routes.
    </Callout>

    <Callout type="info">
    **Express v5:** Use `/api/auth/{*any}` instead of `/api/auth/*` due to changes in route path matching. See the [Express v5 migration guide](https://expressjs.com/en/guide/migrating-5.html).
    </Callout>
  </Tab>
  
  <Tab value="fastify">
    ```ts title="server.ts"
    import Fastify from "fastify";
    import { toNodeHandler } from "better-auth/node";
    import { auth } from "./auth";

    const fastify = Fastify();
    const nodeHandler = toNodeHandler(auth);

    fastify.all("/api/auth/*", async (request, reply) => {
      nodeHandler(request.raw, reply.raw);
    });

    fastify.listen({ port: 3000 }, (err) => {
      if (err) throw err;
      console.log("Server listening on port 3000");
    });
    ```

    See the [Fastify integration guide](/docs/integrations/fastify) for more details.
  </Tab>
  
  <Tab value="hono">
    Hono works with standard Request/Response objects, so you can use the handler directly:

    ```ts title="server.ts"
    import { Hono } from "hono";
    import { auth } from "./auth";

    const app = new Hono();

    app.on(["POST", "GET"], "/api/auth/*", (c) => auth.handler(c.req.raw));

    export default app;
    ```
  </Tab>
  
  <Tab value="raw-node">
    ```ts title="server.ts"
    import { createServer } from "node:http";
    import { toNodeHandler } from "better-auth/node";
    import { auth } from "./auth";

    const handler = toNodeHandler(auth);

    const server = createServer((req, res) => {
      if (req.url?.startsWith("/api/auth")) {
        handler(req, res);
      } else {
        res.writeHead(404);
        res.end("Not found");
      }
    });

    server.listen(3000, () => {
      console.log("Server listening on port 3000");
    });
    ```
  </Tab>
</Tabs>
</Step>

<Step>
### Create Client Instance

Create a client instance to interact with Better Auth from your frontend:

```ts title="client/auth-client.ts"
import { createAuthClient } from "better-auth/client";

export const authClient = createAuthClient({
  baseURL: "http://localhost:3000",
});
```
</Step>

</Steps>

## Usage

### Getting Session

Use `fromNodeHeaders` to convert Node.js headers to a standard Headers object:

```ts title="server.ts"
import { fromNodeHeaders } from "better-auth/node";
import { auth } from "./auth";

app.get("/api/me", async (req, res) => {
  const session = await auth.api.getSession({
    headers: fromNodeHeaders(req.headers),
  });

  if (!session) {
    return res.status(401).json({ error: "Unauthorized" });
  }

  return res.json(session.user);
});
```

### CORS Configuration

For cross-origin requests, configure CORS middleware:

```ts title="server.ts"
import express from "express";
import cors from "cors";
import { toNodeHandler } from "better-auth/node";
import { auth } from "./auth";

const app = express();

// Configure CORS
app.use(
  cors({
    origin: "http://your-frontend-domain.com",
    methods: ["GET", "POST", "PUT", "DELETE"],
    credentials: true, // Allow cookies
  })
);

app.all("/api/auth/*", toNodeHandler(auth));
app.use(express.json());

app.listen(3000);
```

### Protected Routes

Create middleware to protect routes:

```ts title="middleware/auth.ts"
import { Request, Response, NextFunction } from "express";
import { fromNodeHeaders } from "better-auth/node";
import { auth } from "../auth";

export async function requireAuth(
  req: Request,
  res: Response,
  next: NextFunction
) {
  const session = await auth.api.getSession({
    headers: fromNodeHeaders(req.headers),
  });

  if (!session) {
    return res.status(401).json({ error: "Unauthorized" });
  }

  req.user = session.user;
  next();
}
```

Use the middleware:

```ts
import { requireAuth } from "./middleware/auth";

app.get("/api/protected", requireAuth, (req, res) => {
  res.json({ message: `Hello, ${req.user.name}` });
});
```

## API Reference

### `toNodeHandler(auth)`

Converts Better Auth handler to a Node.js request handler compatible with Express, Fastify, and other Node.js frameworks.

**Parameters:**
- `auth`: Better Auth instance or handler function

**Returns:** Node.js request handler `(req, res) => void`

**Source:** [node.ts:5-13](/home/daytona/workspace/source/packages/better-auth/src/integrations/node.ts:5-13)

**Example:**
```ts
import { toNodeHandler } from "better-auth/node";
import { auth } from "./auth";

const handler = toNodeHandler(auth);
app.all("/api/auth/*", handler);
```

### `fromNodeHeaders(nodeHeaders)`

Converts Node.js IncomingHttpHeaders to a standard Headers object for use with Better Auth.

**Parameters:**
- `nodeHeaders`: Node.js IncomingHttpHeaders object

**Returns:** Standard Headers object

**Source:** [node.ts:15-27](/home/daytona/workspace/source/packages/better-auth/src/integrations/node.ts:15-27)

**Example:**
```ts
import { fromNodeHeaders } from "better-auth/node";

const session = await auth.api.getSession({
  headers: fromNodeHeaders(req.headers),
});
```

## Framework-Specific Guides

For detailed integration guides with specific frameworks:

- [Express](/docs/integrations/express)
- [Fastify](/docs/integrations/fastify)
- [NestJS](/docs/integrations/nestjs)
- [Hono](/docs/integrations/hono)

## Related

- [Installation Guide](/docs/installation)
- [Session Management](/docs/concepts/sessions)
- [Client Documentation](/docs/client/vanilla)
