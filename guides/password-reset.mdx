---
title: Password Reset
description: Implement secure password reset functionality in your Better Auth application.
---

Password reset is a critical security feature that allows users to regain access to their accounts when they forget their passwords. This guide covers implementing secure password reset flows with Better Auth.

## Overview

Better Auth provides built-in password reset functionality with:

- Secure token-based password reset
- Configurable token expiration
- Email delivery integration
- Optional session revocation on password change
- Protection against timing attacks

## Basic Setup

<Steps>
<Step>
### Configure Password Reset

Add password reset configuration to your auth setup:

```ts title="auth.ts"
import { betterAuth } from "better-auth";
import { sendEmail } from "./email";

export const auth = betterAuth({
  emailAndPassword: {
    enabled: true,
    
    // Password reset email sender
    sendResetPassword: async ({ user, url, token }, request) => {
      await sendEmail({
        to: user.email,
        subject: "Reset your password",
        html: `
          <h1>Reset Your Password</h1>
          <p>You requested to reset your password. Click the link below to create a new password:</p>
          <a href="${url}">Reset Password</a>
          <p>This link will expire in 1 hour.</p>
          <p>If you didn't request this, you can safely ignore this email.</p>
        `,
      });
    },
    
    // Token expiration (in seconds)
    resetPasswordTokenExpiresIn: 60 * 60, // 1 hour
    
    // Revoke all sessions when password is reset
    revokeSessionsOnPasswordReset: false,
    
    // Callback after password reset
    onPasswordReset: async ({ user }, request) => {
      console.log(`Password reset for user ${user.id}`);
      // Send confirmation email, log event, etc.
    },
  },
  // ...
});
```
</Step>

<Step>
### Create Reset Password Page

Implement the frontend form for requesting a password reset:

```tsx title="app/forgot-password/page.tsx"
"use client";

import { useState } from "react";
import { authClient } from "@/lib/auth-client";

export default function ForgotPasswordPage() {
  const [email, setEmail] = useState("");
  const [status, setStatus] = useState<"idle" | "loading" | "success" | "error">("idle");
  const [message, setMessage] = useState("");

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setStatus("loading");

    try {
      await authClient.forgetPassword({
        email,
        redirectTo: "/reset-password",
      });
      
      setStatus("success");
      setMessage(
        "If an account exists with that email, you will receive a password reset link shortly."
      );
    } catch (error) {
      setStatus("error");
      setMessage("An error occurred. Please try again.");
    }
  };

  return (
    <div className="max-w-md mx-auto mt-8 p-6 border rounded-lg">
      <h1 className="text-2xl font-bold mb-4">Forgot Password</h1>
      
      <form onSubmit={handleSubmit}>
        <div className="mb-4">
          <label htmlFor="email" className="block mb-2">
            Email Address
          </label>
          <input
            id="email"
            type="email"
            value={email}
            onChange={(e) => setEmail(e.target.value)}
            required
            className="w-full px-3 py-2 border rounded"
            placeholder="your@email.com"
          />
        </div>

        <button
          type="submit"
          disabled={status === "loading"}
          className="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 disabled:opacity-50"
        >
          {status === "loading" ? "Sending..." : "Send Reset Link"}
        </button>
      </form>

      {message && (
        <div className={`mt-4 p-3 rounded ${
          status === "success" 
            ? "bg-green-100 text-green-800" 
            : "bg-red-100 text-red-800"
        }`}>
          {message}
        </div>
      )}
    </div>
  );
}
```
</Step>

<Step>
### Create Reset Password Form

Implement the form where users enter their new password:

```tsx title="app/reset-password/page.tsx"
"use client";

import { useState } from "react";
import { useSearchParams, useRouter } from "next/navigation";
import { authClient } from "@/lib/auth-client";

export default function ResetPasswordPage() {
  const searchParams = useSearchParams();
  const router = useRouter();
  const token = searchParams.get("token");
  
  const [password, setPassword] = useState("");
  const [confirmPassword, setConfirmPassword] = useState("");
  const [status, setStatus] = useState<"idle" | "loading" | "success" | "error">("idle");
  const [message, setMessage] = useState("");

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    if (password !== confirmPassword) {
      setStatus("error");
      setMessage("Passwords do not match");
      return;
    }
    
    if (!token) {
      setStatus("error");
      setMessage("Invalid reset token");
      return;
    }

    setStatus("loading");

    try {
      await authClient.resetPassword({
        newPassword: password,
        token,
      });
      
      setStatus("success");
      setMessage("Password reset successful! Redirecting to login...");
      
      setTimeout(() => {
        router.push("/login");
      }, 2000);
    } catch (error: any) {
      setStatus("error");
      if (error.message?.includes("PASSWORD_TOO_SHORT")) {
        setMessage("Password is too short. Minimum 8 characters required.");
      } else if (error.message?.includes("INVALID_TOKEN")) {
        setMessage("Invalid or expired reset token. Please request a new one.");
      } else {
        setMessage("Failed to reset password. Please try again.");
      }
    }
  };

  if (!token) {
    return (
      <div className="max-w-md mx-auto mt-8 p-6 border rounded-lg">
        <h1 className="text-2xl font-bold mb-4">Invalid Reset Link</h1>
        <p>This password reset link is invalid or has expired.</p>
        <a href="/forgot-password" className="text-blue-600 hover:underline">
          Request a new reset link
        </a>
      </div>
    );
  }

  return (
    <div className="max-w-md mx-auto mt-8 p-6 border rounded-lg">
      <h1 className="text-2xl font-bold mb-4">Reset Your Password</h1>
      
      <form onSubmit={handleSubmit}>
        <div className="mb-4">
          <label htmlFor="password" className="block mb-2">
            New Password
          </label>
          <input
            id="password"
            type="password"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
            required
            minLength={8}
            className="w-full px-3 py-2 border rounded"
          />
        </div>

        <div className="mb-4">
          <label htmlFor="confirmPassword" className="block mb-2">
            Confirm Password
          </label>
          <input
            id="confirmPassword"
            type="password"
            value={confirmPassword}
            onChange={(e) => setConfirmPassword(e.target.value)}
            required
            minLength={8}
            className="w-full px-3 py-2 border rounded"
          />
        </div>

        <button
          type="submit"
          disabled={status === "loading"}
          className="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 disabled:opacity-50"
        >
          {status === "loading" ? "Resetting..." : "Reset Password"}
        </button>
      </form>

      {message && (
        <div className={`mt-4 p-3 rounded ${
          status === "success" 
            ? "bg-green-100 text-green-800" 
            : "bg-red-100 text-red-800"
        }`}>
          {message}
        </div>
      )}
    </div>
  );
}
```
</Step>
</Steps>

## Password Reset Flow

The complete password reset flow works as follows:

1. User visits forgot password page and enters their email
2. Client calls `authClient.forgetPassword({ email, redirectTo })`
3. Server generates a secure token and stores it in the verification table
4. Reset email is sent with a link containing the token
5. User clicks the link and is redirected to reset password page
6. User enters new password and submits
7. Client calls `authClient.resetPassword({ newPassword, token })`
8. Server validates token, hashes new password, and updates account
9. Optional: All sessions are revoked
10. User can now sign in with new password

## Advanced Configuration

### Custom Token Expiration

Adjust how long reset links remain valid:

```ts title="auth.ts"
export const auth = betterAuth({
  emailAndPassword: {
    sendResetPassword: async ({ user, url }) => {
      await sendEmail({ to: user.email, url });
    },
    
    // Expire tokens after 2 hours
    resetPasswordTokenExpiresIn: 60 * 60 * 2, // 2 hours (in seconds)
  },
});
```

### Revoke Sessions on Password Reset

For enhanced security, automatically sign out all devices when password is reset:

```ts title="auth.ts"
export const auth = betterAuth({
  emailAndPassword: {
    sendResetPassword: async ({ user, url }) => {
      await sendEmail({ to: user.email, url });
    },
    
    // Revoke all existing sessions
    revokeSessionsOnPasswordReset: true,
  },
});
```

<Note>
When enabled, users will need to sign in again on all devices after resetting their password.
</Note>

### Password Reset Callbacks

Execute custom logic after a password reset:

```ts title="auth.ts"
export const auth = betterAuth({
  emailAndPassword: {
    sendResetPassword: async ({ user, url }) => {
      await sendEmail({ to: user.email, url });
    },
    
    onPasswordReset: async ({ user }, request) => {
      // Send confirmation email
      await sendEmail({
        to: user.email,
        subject: "Password Changed Successfully",
        html: `
          <h1>Password Changed</h1>
          <p>Your password was successfully changed.</p>
          <p>If you didn't make this change, please contact support immediately.</p>
        `,
      });
      
      // Log security event
      await logSecurityEvent({
        userId: user.id,
        event: "password_reset",
        timestamp: new Date(),
        ip: request?.headers.get("x-forwarded-for"),
      });
      
      // Notify admin for suspicious activity
      const recentResets = await getRecentPasswordResets(user.id);
      if (recentResets > 3) {
        await notifyAdmin({
          userId: user.id,
          reason: "Multiple password resets in short period",
        });
      }
    },
  },
});
```

## Security Best Practices

### Timing Attack Protection

Better Auth automatically implements timing attack protection in the password reset flow:

```ts
// Even if user doesn't exist, simulate token generation
// to prevent timing attacks
if (!user) {
  generateId(24);
  await ctx.context.internalAdapter.findVerificationValue(
    "dummy-verification-token",
  );
  // Return success to avoid leaking user existence
  return ctx.json({ status: true });
}
```

### Rate Limiting

Protect password reset endpoints from abuse:

```ts title="auth.ts"
export const auth = betterAuth({
  rateLimit: {
    enabled: true,
    customRules: {
      "/request-password-reset": {
        window: 60 * 60, // 1 hour
        max: 3, // max 3 requests per hour
      },
      "/reset-password": {
        window: 60 * 60, // 1 hour
        max: 5, // max 5 attempts per hour
      },
    },
  },
});
```

### Strong Password Requirements

Enforce strong password policies:

```ts title="auth.ts"
export const auth = betterAuth({
  emailAndPassword: {
    enabled: true,
    minPasswordLength: 12, // require longer passwords
    maxPasswordLength: 128,
  },
});
```

## Troubleshooting

### Reset Emails Not Arriving

1. Check email service configuration
2. Verify environment variables
3. Check spam/junk folders
4. Review email service logs
5. Test with a different email provider

### Tokens Expiring Too Quickly

Increase the `resetPasswordTokenExpiresIn` value:

```ts
resetPasswordTokenExpiresIn: 60 * 60 * 24, // 24 hours
```

### "Invalid Token" Errors

1. Verify token is being passed correctly in URL
2. Check token hasn't expired
3. Ensure token hasn't been used already
4. Verify database connection is working

## Next Steps

<Cards>
  <Card href="/docs/guides/email-verification" title="Email Verification" description="Verify user email addresses" />
  <Card href="/docs/guides/rate-limiting" title="Rate Limiting" description="Protect against brute force attacks" />
  <Card href="/docs/authentication/email-password" title="Email/Password Auth" description="Learn more about email/password authentication" />
</Cards>