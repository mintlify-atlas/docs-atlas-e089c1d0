---
title: OAuth Setup
description: Configure social authentication providers with Better Auth.
---

This guide covers setting up OAuth providers (Google, GitHub, Discord, etc.) for social authentication in your Better Auth application.

## Overview

Better Auth supports 40+ OAuth providers out of the box with:

- Built-in provider configurations
- Automatic token management
- Flexible account linking
- Custom provider support

## Quick Start

<Steps>
<Step>
### Install Better Auth

If you haven't already, install Better Auth:

```bash
npm install better-auth
```
</Step>

<Step>
### Configure Providers

Add social providers to your auth configuration:

```ts title="auth.ts"
import { betterAuth } from "better-auth";

export const auth = betterAuth({
  database: {
    // your database config
  },
  socialProviders: {
    google: {
      clientId: process.env.GOOGLE_CLIENT_ID!,
      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
    },
    github: {
      clientId: process.env.GITHUB_CLIENT_ID!,
      clientSecret: process.env.GITHUB_CLIENT_SECRET!,
    },
  },
});
```
</Step>

<Step>
### Use in Client

Sign in with OAuth from your client:

```tsx title="components/SignIn.tsx"
import { authClient } from "@/lib/auth-client";

export function SignIn() {
  const signInWithGoogle = async () => {
    await authClient.signIn.social({
      provider: "google",
      callbackURL: "/dashboard",
    });
  };

  const signInWithGitHub = async () => {
    await authClient.signIn.social({
      provider: "github",
      callbackURL: "/dashboard",
    });
  };

  return (
    <div>
      <button onClick={signInWithGoogle}>Sign in with Google</button>
      <button onClick={signInWithGitHub}>Sign in with GitHub</button>
    </div>
  );
}
```
</Step>
</Steps>

## Popular Providers

### Google

<Steps>
<Step>
#### Create OAuth App

1. Go to [Google Cloud Console](https://console.cloud.google.com/)
2. Create a new project or select existing
3. Navigate to "APIs & Services" > "Credentials"
4. Click "Create Credentials" > "OAuth client ID"
5. Choose "Web application"
6. Add authorized redirect URIs:
   - Development: `http://localhost:3000/api/auth/callback/google`
   - Production: `https://yourdomain.com/api/auth/callback/google`
</Step>

<Step>
#### Configure in Better Auth

```ts title="auth.ts"
export const auth = betterAuth({
  socialProviders: {
    google: {
      clientId: process.env.GOOGLE_CLIENT_ID!,
      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
      // Optional: customize scopes
      scope: ["openid", "email", "profile"],
    },
  },
});
```
</Step>

<Step>
#### Environment Variables

```env title=".env"
GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-client-secret
```
</Step>
</Steps>

### GitHub

<Steps>
<Step>
#### Create OAuth App

1. Go to GitHub Settings > Developer settings > [OAuth Apps](https://github.com/settings/developers)
2. Click "New OAuth App"
3. Fill in the application details:
   - **Homepage URL**: `https://yourdomain.com`
   - **Authorization callback URL**: `https://yourdomain.com/api/auth/callback/github`
4. For development, create a separate app with `http://localhost:3000/api/auth/callback/github`
</Step>

<Step>
#### Configure in Better Auth

```ts title="auth.ts"
export const auth = betterAuth({
  socialProviders: {
    github: {
      clientId: process.env.GITHUB_CLIENT_ID!,
      clientSecret: process.env.GITHUB_CLIENT_SECRET!,
      // Optional: request additional scopes
      scope: ["user:email"],
    },
  },
});
```
</Step>

<Step>
#### Environment Variables

```env title=".env"
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret
```
</Step>
</Steps>

### Discord

<Steps>
<Step>
#### Create OAuth App

1. Go to [Discord Developer Portal](https://discord.com/developers/applications)
2. Click "New Application"
3. Navigate to "OAuth2" settings
4. Add redirect URLs:
   - Development: `http://localhost:3000/api/auth/callback/discord`
   - Production: `https://yourdomain.com/api/auth/callback/discord`
</Step>

<Step>
#### Configure in Better Auth

```ts title="auth.ts"
export const auth = betterAuth({
  socialProviders: {
    discord: {
      clientId: process.env.DISCORD_CLIENT_ID!,
      clientSecret: process.env.DISCORD_CLIENT_SECRET!,
      prompt: "none", // "none" or "consent"
    },
  },
});
```
</Step>

<Step>
#### Environment Variables

```env title=".env"
DISCORD_CLIENT_ID=your-discord-client-id
DISCORD_CLIENT_SECRET=your-discord-client-secret
```
</Step>
</Steps>

## All Supported Providers

Better Auth supports these providers out of the box:

- **Google** - `google`
- **GitHub** - `github`
- **Discord** - `discord`
- **Facebook** - `facebook`
- **Apple** - `apple`
- **Microsoft** - `microsoft`
- **Twitter/X** - `twitter`
- **LinkedIn** - `linkedin`
- **Spotify** - `spotify`
- **Twitch** - `twitch`
- **GitLab** - `gitlab`
- **Slack** - `slack`
- **Dropbox** - `dropbox`
- **Notion** - `notion`
- **Atlassian** - `atlassian`
- **Cognito** - `cognito`
- And 25+ more!

Each provider follows a similar configuration pattern.

## Advanced Configuration

### Custom Redirect URI

Override the default redirect URI for a provider:

```ts title="auth.ts"
export const auth = betterAuth({
  socialProviders: {
    google: {
      clientId: process.env.GOOGLE_CLIENT_ID!,
      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
      redirectURI: "https://custom.domain.com/auth/google/callback",
    },
  },
});
```

### Custom Scopes

Request additional permissions from providers:

```ts title="auth.ts"
export const auth = betterAuth({
  socialProviders: {
    google: {
      clientId: process.env.GOOGLE_CLIENT_ID!,
      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
      scope: [
        "openid",
        "email",
        "profile",
        "https://www.googleapis.com/auth/calendar.readonly", // Additional scope
      ],
    },
    github: {
      clientId: process.env.GITHUB_CLIENT_ID!,
      clientSecret: process.env.GITHUB_CLIENT_SECRET!,
      scope: [
        "user:email",
        "read:user",
        "repo", // Additional scope for repository access
      ],
    },
  },
});
```

### Map Profile Data

Customize how provider profile data maps to your user model:

```ts title="auth.ts"
export const auth = betterAuth({
  socialProviders: {
    google: {
      clientId: process.env.GOOGLE_CLIENT_ID!,
      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
      mapProfileToUser: (profile) => {
        return {
          email: profile.email,
          name: profile.name,
          image: profile.picture,
          // Add custom fields
          locale: profile.locale,
          emailVerified: profile.email_verified,
        };
      },
    },
  },
});
```

### Disable Default Scopes

If you want complete control over scopes:

```ts title="auth.ts"
export const auth = betterAuth({
  socialProviders: {
    github: {
      clientId: process.env.GITHUB_CLIENT_ID!,
      clientSecret: process.env.GITHUB_CLIENT_SECRET!,
      disableDefaultScope: true, // Don't include default scopes
      scope: ["user:email"], // Only use these scopes
    },
  },
});
```

## Account Linking

Configure how social accounts are linked to existing users:

```ts title="auth.ts"
export const auth = betterAuth({
  account: {
    accountLinking: {
      enabled: true,
      
      // Automatically link accounts with same verified email
      trustedProviders: ["google", "github", "microsoft"],
      
      // Disable automatic linking on sign-in
      disableImplicitLinking: false,
      
      // Allow linking accounts with different emails
      allowDifferentEmails: false,
      
      // Update user info when linking new account
      updateUserInfoOnLink: true,
    },
  },
});
```

### Manual Account Linking

Allow users to manually link social accounts:

```tsx title="components/LinkAccount.tsx"
import { authClient } from "@/lib/auth-client";

export function LinkAccount() {
  const linkGitHub = async () => {
    await authClient.linkSocial({
      provider: "github",
      callbackURL: "/settings/accounts",
    });
  };

  return (
    <div>
      <h2>Connected Accounts</h2>
      <button onClick={linkGitHub}>
        Link GitHub Account
      </button>
    </div>
  );
}
```

## Custom OAuth Provider

You can add custom OAuth providers not included by default:

```ts title="custom-provider.ts"
import type { OAuthProvider } from "better-auth";

export const customProvider = (options: {
  clientId: string;
  clientSecret: string;
}): OAuthProvider => ({
  id: "custom",
  name: "Custom Provider",
  
  createAuthorizationURL({ state, redirectURI }) {
    const params = new URLSearchParams({
      client_id: options.clientId,
      redirect_uri: redirectURI,
      response_type: "code",
      state,
      scope: "openid profile email",
    });
    return new URL(`https://provider.com/oauth/authorize?${params}`);
  },
  
  async validateAuthorizationCode({ code, redirectURI }) {
    const response = await fetch("https://provider.com/oauth/token", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        grant_type: "authorization_code",
        code,
        client_id: options.clientId,
        client_secret: options.clientSecret,
        redirect_uri: redirectURI,
      }),
    });
    
    return await response.json();
  },
  
  async getUserInfo(token) {
    const response = await fetch("https://provider.com/oauth/userinfo", {
      headers: {
        Authorization: `Bearer ${token.accessToken}`,
      },
    });
    
    const profile = await response.json();
    
    return {
      user: {
        id: profile.id,
        name: profile.name,
        email: profile.email,
        image: profile.avatar_url,
        emailVerified: profile.email_verified,
      },
      data: profile,
    };
  },
});
```

Then use it in your configuration:

```ts title="auth.ts"
import { betterAuth } from "better-auth";
import { customProvider } from "./custom-provider";

export const auth = betterAuth({
  socialProviders: {
    custom: customProvider({
      clientId: process.env.CUSTOM_CLIENT_ID!,
      clientSecret: process.env.CUSTOM_CLIENT_SECRET!,
    }),
  },
});
```

## Token Management

### Encrypt OAuth Tokens

For enhanced security, encrypt OAuth tokens in the database:

```ts title="auth.ts"
export const auth = betterAuth({
  account: {
    encryptOAuthTokens: true, // Encrypt access/refresh tokens
  },
});
```

### Refresh Tokens

Access refresh tokens to get new access tokens:

```ts title="lib/refresh-token.ts"
import { auth } from "./auth";

export async function refreshUserToken(userId: string, provider: string) {
  const account = await getAccountForUser(userId, provider);
  
  if (!account.refreshToken) {
    throw new Error("No refresh token available");
  }
  
  // Use provider-specific refresh method
  const newTokens = await refreshProviderToken(provider, account.refreshToken);
  
  // Update account with new tokens
  await updateAccountTokens(account.id, newTokens);
  
  return newTokens;
}
```

## Security Best Practices

1. **Use HTTPS**: Always use HTTPS in production
2. **Secure secrets**: Never commit client secrets to version control
3. **Validate redirect URIs**: Only whitelist specific callback URLs in provider settings
4. **State parameter**: Better Auth automatically handles CSRF protection via state parameter
5. **Token encryption**: Enable `encryptOAuthTokens` for sensitive applications
6. **Scope minimization**: Only request scopes you actually need

## Testing OAuth Locally

### Using ngrok

To test OAuth callbacks locally:

1. Install ngrok: `npm install -g ngrok`
2. Start your dev server: `npm run dev`
3. Create tunnel: `ngrok http 3000`
4. Update provider callback URL to ngrok URL
5. Update `BETTER_AUTH_URL` in `.env`

```env title=".env.local"
BETTER_AUTH_URL=https://your-ngrok-url.ngrok.io
```

### Development vs Production

Maintain separate OAuth apps for dev and production:

```ts title="auth.ts"
const isDevelopment = process.env.NODE_ENV === "development";

export const auth = betterAuth({
  socialProviders: {
    google: {
      clientId: isDevelopment 
        ? process.env.GOOGLE_CLIENT_ID_DEV!
        : process.env.GOOGLE_CLIENT_ID_PROD!,
      clientSecret: isDevelopment
        ? process.env.GOOGLE_CLIENT_SECRET_DEV!
        : process.env.GOOGLE_CLIENT_SECRET_PROD!,
    },
  },
});
```

## Troubleshooting

### "redirect_uri_mismatch" Error

1. Verify the callback URL in provider settings matches exactly
2. Check for trailing slashes
3. Ensure protocol (http/https) matches
4. Verify the `basePath` configuration

### "invalid_client" Error

1. Check client ID and secret are correct
2. Verify environment variables are loaded
3. Ensure no extra spaces in credentials

### Users Not Being Created

1. Check database connection
2. Verify user table schema includes required fields
3. Review console logs for errors
4. Ensure `mapProfileToUser` returns all required fields

### Tokens Not Refreshing

1. Verify refresh token is being stored
2. Check if provider supports refresh tokens
3. Ensure correct scopes are requested (some require `offline_access`)

## Next Steps

<Cards>
  <Card href="/docs/authentication/social-providers" title="Social Providers" description="Complete list of supported providers" />
  <Card href="/docs/guides/custom-fields" title="Custom Fields" description="Add custom fields to your user model" />
  <Card href="/docs/plugins/generic-oauth" title="Generic OAuth" description="Use the generic OAuth plugin for any provider" />
</Cards>