---
title: Phone Number
description: Phone number authentication with SMS OTP verification
---

## Overview

The Phone Number plugin enables authentication using phone numbers and SMS OTP codes. It supports sign-in, verification, and password reset flows with customizable OTP handling and phone number validation.

## Features

- **SMS OTP Authentication** - Sign in with phone number and SMS codes
- **Phone Verification** - Verify phone numbers with OTP codes
- **Password Reset** - Reset passwords using phone number OTP
- **Custom OTP Handling** - Integrate with any SMS provider (Twilio, Vonage, etc.)
- **Custom Verification** - Override verification logic for provider-managed OTP
- **Phone Validation** - Validate phone number formats
- **Auto Sign-Up** - Create users automatically on verification
- **Protected Updates** - Prevent unauthorized phone number changes
- **Rate Limiting** - Built-in protection against SMS abuse

## Use Cases

- Phone-based authentication for mobile apps
- SMS verification for account security
- Multi-region authentication with phone numbers
- Passwordless authentication via SMS
- Account recovery with phone number verification

## Installation

The Phone Number plugin is included in Better Auth:

```bash
npm install better-auth
```

## Configuration

### Plugin Options

<ParamField path="sendOTP" type="function" required>
  Function to send OTP via SMS.
  
  **Parameters:**
  - `phoneNumber` (string) - Recipient phone number
  - `code` (string) - The OTP code
  - `ctx` (GenericEndpointContext, optional) - Request context
  
  **Returns:** `Promise<void>`
</ParamField>

<ParamField path="verifyOTP" type="function" optional>
  Custom OTP verification function. Useful when SMS provider handles verification.
  
  **Parameters:**
  - `phoneNumber` (string) - Phone number
  - `code` (string) - OTP code to verify
  - `ctx` (GenericEndpointContext, optional) - Request context
  
  **Returns:** `Promise<boolean>` - True if valid
</ParamField>

<ParamField path="sendPasswordResetOTP" type="function" optional>
  Function to send password reset OTP. If not provided, uses `sendOTP`.
  
  **Parameters:**
  - `phoneNumber` (string) - Phone number
  - `code` (string) - OTP code
  - `ctx` (GenericEndpointContext, optional) - Request context
  
  **Returns:** `Promise<void>`
</ParamField>

<ParamField path="otpLength" type="number" default={6}>
  Length of the OTP code.
</ParamField>

<ParamField path="expiresIn" type="number" default={300}>
  OTP expiration time in seconds (default: 5 minutes).
</ParamField>

<ParamField path="phoneNumberValidator" type="function" optional>
  Custom phone number validation function.
  
  **Parameters:**
  - `phoneNumber` (string) - Phone number to validate
  
  **Returns:** `Promise<boolean>` - True if valid
</ParamField>

<ParamField path="requireVerification" type="boolean" default={false}>
  Require phone number verification before allowing sign-in.
</ParamField>

<ParamField path="callbackOnVerification" type="function" optional>
  Callback function executed after successful verification.
  
  **Parameters:**
  - `phoneNumber` (string) - Verified phone number
  - `user` (UserWithPhoneNumber) - User object
  - `ctx` (GenericEndpointContext, optional) - Request context
  
  **Returns:** `Promise<void>`
</ParamField>

<ParamField path="signUpOnVerification" type="object" optional>
  Auto-create users on phone verification.
  
  <Expandable title="Sign Up Options">
    <ParamField path="getTempEmail" type="function" required>
      Generate temporary email from phone number.
      
      **Parameters:**
      - `phoneNumber` (string) - Phone number
      
      **Returns:** `string` - Temporary email
    </ParamField>
    
    <ParamField path="getTempName" type="function" optional>
      Generate temporary name from phone number. Defaults to phone number.
      
      **Parameters:**
      - `phoneNumber` (string) - Phone number
      
      **Returns:** `string` - Temporary name
    </ParamField>
  </Expandable>
</ParamField>

<ParamField path="allowedAttempts" type="number" default={3}>
  Maximum OTP verification attempts before requiring new code.
</ParamField>

<ParamField path="schema" type="InferOptionSchema" optional>
  Custom schema configuration for phone number fields.
</ParamField>

## Setup

<Steps>

<Step title="Configure the plugin">

```ts title="auth.ts"
import { betterAuth } from "better-auth"
import { phoneNumber } from "better-auth/plugins"
import { Twilio } from "twilio"

const twilioClient = new Twilio(
  process.env.TWILIO_ACCOUNT_SID,
  process.env.TWILIO_AUTH_TOKEN
)

export const auth = betterAuth({
  database: {
    // your database configuration
  },
  plugins: [
    phoneNumber({
      sendOTP: async ({ phoneNumber, code }, ctx) => {
        await twilioClient.messages.create({
          body: `Your verification code is: ${code}`,
          from: process.env.TWILIO_PHONE_NUMBER,
          to: phoneNumber,
        })
      },
      otpLength: 6,
      expiresIn: 300, // 5 minutes
      phoneNumberValidator: async (phoneNumber) => {
        // Validate E.164 format
        return /^\+[1-9]\d{1,14}$/.test(phoneNumber)
      },
      signUpOnVerification: {
        getTempEmail: (phoneNumber) => `${phoneNumber}@temp.myapp.com`,
        getTempName: (phoneNumber) => phoneNumber,
      },
      allowedAttempts: 3,
    }),
  ],
})
```

</Step>

<Step title="Run database migrations">

```bash
npx better-auth migrate
```

This adds phone number fields to the user table:
- `phoneNumber` (string, nullable, unique)
- `phoneNumberVerified` (boolean)

</Step>

<Step title="Set up environment variables">

```bash title=".env"
# Twilio
TWILIO_ACCOUNT_SID=ACxxxxx
TWILIO_AUTH_TOKEN=your-auth-token
TWILIO_PHONE_NUMBER=+1234567890

# Or Vonage (Nexmo)
VONAGE_API_KEY=your-api-key
VONAGE_API_SECRET=your-api-secret
VONAGE_FROM_NUMBER=+1234567890
```

</Step>

<Step title="Set up client plugin">

```ts title="lib/auth-client.ts"
import { createAuthClient } from "better-auth/react"
import { phoneNumberClient } from "better-auth/client/plugins"

export const authClient = createAuthClient({
  baseURL: "http://localhost:3000",
  plugins: [phoneNumberClient()],
})
```

</Step>

</Steps>

## Client Usage

### Sign In with Phone Number

<Tabs items={["React", "Vue", "Svelte", "Vanilla"]}>

<Tab value="React">

```tsx title="components/PhoneSignIn.tsx"
import { authClient } from "@/lib/auth-client"
import { useState } from "react"

export function PhoneSignIn() {
  const [phoneNumber, setPhoneNumber] = useState("")
  const [otp, setOtp] = useState("")
  const [step, setStep] = useState<"phone" | "verify">("phone")
  const [loading, setLoading] = useState(false)

  const handleSendOTP = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    
    try {
      await authClient.phoneNumber.sendOtp({
        phoneNumber,
        type: "sign-in",
      })
      setStep("verify")
    } catch (error) {
      console.error("Failed to send OTP:", error)
    } finally {
      setLoading(false)
    }
  }

  const handleVerifyOTP = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    
    try {
      await authClient.phoneNumber.signIn({
        phoneNumber,
        code: otp,
      })
      window.location.href = "/dashboard"
    } catch (error) {
      console.error("Invalid OTP:", error)
    } finally {
      setLoading(false)
    }
  }

  if (step === "verify") {
    return (
      <form onSubmit={handleVerifyOTP}>
        <h2>Enter verification code</h2>
        <p>We sent a code to {phoneNumber}</p>
        
        <input
          type="text"
          value={otp}
          onChange={(e) => setOtp(e.target.value)}
          placeholder="Enter 6-digit code"
          maxLength={6}
          pattern="[0-9]{6}"
          required
          disabled={loading}
        />
        
        <button type="submit" disabled={loading}>
          {loading ? "Verifying..." : "Verify"}
        </button>
        
        <button type="button" onClick={() => setStep("phone")}>
          Change number
        </button>
      </form>
    )
  }

  return (
    <form onSubmit={handleSendOTP}>
      <h2>Sign in with phone</h2>
      
      <input
        type="tel"
        value={phoneNumber}
        onChange={(e) => setPhoneNumber(e.target.value)}
        placeholder="+1234567890"
        required
        disabled={loading}
      />
      
      <button type="submit" disabled={loading}>
        {loading ? "Sending..." : "Send code"}
      </button>
    </form>
  )
}
```

</Tab>

<Tab value="Vue">

```vue title="components/PhoneSignIn.vue"
<script setup lang="ts">
import { ref } from 'vue'
import { authClient } from '@/lib/auth-client'

const phoneNumber = ref('')
const otp = ref('')
const step = ref<'phone' | 'verify'>('phone')
const loading = ref(false)

const handleSendOTP = async () => {
  loading.value = true
  try {
    await authClient.phoneNumber.sendOtp({
      phoneNumber: phoneNumber.value,
      type: 'sign-in',
    })
    step.value = 'verify'
  } finally {
    loading.value = false
  }
}

const handleVerifyOTP = async () => {
  loading.value = true
  try {
    await authClient.phoneNumber.signIn({
      phoneNumber: phoneNumber.value,
      code: otp.value,
    })
    window.location.href = '/dashboard'
  } finally {
    loading.value = false
  }
}
</script>

<template>
  <div>
    <form v-if="step === 'verify'" @submit.prevent="handleVerifyOTP">
      <h2>Enter verification code</h2>
      <p>We sent a code to {{ phoneNumber }}</p>
      
      <input
        v-model="otp"
        type="text"
        placeholder="Enter 6-digit code"
        maxlength="6"
        required
        :disabled="loading"
      />
      
      <button type="submit" :disabled="loading">
        {{ loading ? 'Verifying...' : 'Verify' }}
      </button>
      
      <button type="button" @click="step = 'phone'">
        Change number
      </button>
    </form>
    
    <form v-else @submit.prevent="handleSendOTP">
      <h2>Sign in with phone</h2>
      
      <input
        v-model="phoneNumber"
        type="tel"
        placeholder="+1234567890"
        required
        :disabled="loading"
      />
      
      <button type="submit" :disabled="loading">
        {{ loading ? 'Sending...' : 'Send code' }}
      </button>
    </form>
  </div>
</template>
```

</Tab>

<Tab value="Svelte">

```svelte title="components/PhoneSignIn.svelte"
<script lang="ts">
  import { authClient } from '$lib/auth-client'

  let phoneNumber = ''
  let otp = ''
  let step: 'phone' | 'verify' = 'phone'
  let loading = false

  async function handleSendOTP() {
    loading = true
    try {
      await authClient.phoneNumber.sendOtp({
        phoneNumber,
        type: 'sign-in',
      })
      step = 'verify'
    } finally {
      loading = false
    }
  }

  async function handleVerifyOTP() {
    loading = true
    try {
      await authClient.phoneNumber.signIn({
        phoneNumber,
        code: otp,
      })
      window.location.href = '/dashboard'
    } finally {
      loading = false
    }
  }
</script>

{#if step === 'verify'}
  <form on:submit|preventDefault={handleVerifyOTP}>
    <h2>Enter verification code</h2>
    <p>We sent a code to {phoneNumber}</p>
    
    <input
      bind:value={otp}
      type="text"
      placeholder="Enter 6-digit code"
      maxlength="6"
      required
      disabled={loading}
    />
    
    <button type="submit" disabled={loading}>
      {loading ? 'Verifying...' : 'Verify'}
    </button>
    
    <button type="button" on:click={() => step = 'phone'}>
      Change number
    </button>
  </form>
{:else}
  <form on:submit|preventDefault={handleSendOTP}>
    <h2>Sign in with phone</h2>
    
    <input
      bind:value={phoneNumber}
      type="tel"
      placeholder="+1234567890"
      required
      disabled={loading}
    />
    
    <button type="submit" disabled={loading}>
      {loading ? 'Sending...' : 'Send code'}
    </button>
  </form>
{/if}
```

</Tab>

<Tab value="Vanilla">

```ts title="phone-signin.ts"
import { authClient } from './lib/auth-client'

let step: 'phone' | 'verify' = 'phone'
let phoneNumber = ''

const phoneForm = document.querySelector('#phone-form') as HTMLFormElement
const verifyForm = document.querySelector('#verify-form') as HTMLFormElement

phoneForm?.addEventListener('submit', async (e) => {
  e.preventDefault()
  
  const formData = new FormData(phoneForm)
  phoneNumber = formData.get('phoneNumber') as string
  
  await authClient.phoneNumber.sendOtp({
    phoneNumber,
    type: 'sign-in',
  })
  
  phoneForm.style.display = 'none'
  verifyForm.style.display = 'block'
})

verifyForm?.addEventListener('submit', async (e) => {
  e.preventDefault()
  
  const formData = new FormData(verifyForm)
  const code = formData.get('code') as string
  
  await authClient.phoneNumber.signIn({ phoneNumber, code })
  window.location.href = '/dashboard'
})
```

</Tab>

</Tabs>

### Verify Phone Number

```tsx
// Send verification OTP
await authClient.phoneNumber.sendOtp({
  phoneNumber: "+1234567890",
  type: "verification",
})

// Verify OTP
await authClient.phoneNumber.verify({
  phoneNumber: "+1234567890",
  code: "123456",
})
```

### Password Reset

```tsx
// Request password reset OTP
await authClient.phoneNumber.requestPasswordReset({
  phoneNumber: "+1234567890",
})

// Reset password with OTP
await authClient.phoneNumber.resetPassword({
  phoneNumber: "+1234567890",
  code: "123456",
  newPassword: "newSecurePassword123",
})
```

## Server Usage

### Sign In

```ts title="app/api/phone/signin/route.ts"
import { auth } from "@/lib/auth"
import { headers } from "next/headers"

export async function POST(request: Request) {
  const { phoneNumber, code } = await request.json()
  
  const result = await auth.api.signInPhoneNumber({
    body: { phoneNumber, code },
    headers: await headers(),
  })
  
  return Response.json(result)
}
```

### Send OTP

```ts title="app/api/phone/send-otp/route.ts"
import { auth } from "@/lib/auth"
import { headers } from "next/headers"

export async function POST(request: Request) {
  const { phoneNumber, type } = await request.json()
  
  const result = await auth.api.sendPhoneNumberOTP({
    body: { phoneNumber, type },
    headers: await headers(),
  })
  
  return Response.json(result)
}
```

## API Reference

### Client Methods

<ResponseField name="phoneNumber.signIn" type="function">
  Sign in using phone number and OTP.
  
  **Parameters:**
  - `phoneNumber` (string, required) - Phone number in E.164 format
  - `code` (string, required) - OTP code
  
  **Returns:** Session and user data
</ResponseField>

<ResponseField name="phoneNumber.sendOtp" type="function">
  Send OTP to phone number.
  
  **Parameters:**
  - `phoneNumber` (string, required) - Phone number
  - `type` ("sign-in" | "verification", required) - OTP type
  
  **Returns:**
  - `status` (boolean) - Whether OTP was sent
</ResponseField>

<ResponseField name="phoneNumber.verify" type="function">
  Verify phone number with OTP.
  
  **Parameters:**
  - `phoneNumber` (string, required) - Phone number
  - `code` (string, required) - OTP code
  
  **Returns:**
  - `status` (boolean) - Verification status
</ResponseField>

<ResponseField name="phoneNumber.requestPasswordReset" type="function">
  Request password reset OTP.
  
  **Parameters:**
  - `phoneNumber` (string, required) - Phone number
  
  **Returns:**
  - `status` (boolean) - Whether OTP was sent
</ResponseField>

<ResponseField name="phoneNumber.resetPassword" type="function">
  Reset password using OTP.
  
  **Parameters:**
  - `phoneNumber` (string, required) - Phone number
  - `code` (string, required) - OTP code
  - `newPassword` (string, required) - New password
  
  **Returns:**
  - `status` (boolean) - Reset status
</ResponseField>

### Server Endpoints

- `POST /sign-in/phone-number` - Sign in with phone
- `POST /phone-number/send-otp` - Send OTP
- `POST /phone-number/verify` - Verify phone number
- `POST /phone-number/request-password-reset` - Request password reset
- `POST /phone-number/reset-password` - Reset password

## SMS Provider Integration

### Twilio

```ts
import { Twilio } from "twilio"

const client = new Twilio(
  process.env.TWILIO_ACCOUNT_SID,
  process.env.TWILIO_AUTH_TOKEN
)

phoneNumber({
  sendOTP: async ({ phoneNumber, code }) => {
    await client.messages.create({
      body: `Your code is: ${code}`,
      from: process.env.TWILIO_PHONE_NUMBER,
      to: phoneNumber,
    })
  },
})
```

### Vonage (Nexmo)

```ts
import { Vonage } from "@vonage/server-sdk"

const vonage = new Vonage({
  apiKey: process.env.VONAGE_API_KEY,
  apiSecret: process.env.VONAGE_API_SECRET,
})

phoneNumber({
  sendOTP: async ({ phoneNumber, code }) => {
    await vonage.sms.send({
      to: phoneNumber,
      from: process.env.VONAGE_FROM_NUMBER,
      text: `Your verification code is: ${code}`,
    })
  },
})
```

### AWS SNS

```ts
import { SNSClient, PublishCommand } from "@aws-sdk/client-sns"

const sns = new SNSClient({ region: process.env.AWS_REGION })

phoneNumber({
  sendOTP: async ({ phoneNumber, code }) => {
    await sns.send(
      new PublishCommand({
        PhoneNumber: phoneNumber,
        Message: `Your verification code is: ${code}`,
      })
    )
  },
})
```

## Custom Verification

Some SMS providers (like Twilio Verify) handle OTP generation and verification:

```ts
import { Twilio } from "twilio"

const client = new Twilio(
  process.env.TWILIO_ACCOUNT_SID,
  process.env.TWILIO_AUTH_TOKEN
)

phoneNumber({
  sendOTP: async ({ phoneNumber }) => {
    // Twilio generates and sends OTP
    await client.verify.v2
      .services(process.env.TWILIO_VERIFY_SERVICE_SID)
      .verifications.create({
        to: phoneNumber,
        channel: "sms",
      })
  },
  verifyOTP: async ({ phoneNumber, code }) => {
    // Twilio verifies OTP
    const verification = await client.verify.v2
      .services(process.env.TWILIO_VERIFY_SERVICE_SID)
      .verificationChecks.create({
        to: phoneNumber,
        code,
      })
    
    return verification.status === "approved"
  },
})
```

## Phone Number Validation

Validate phone numbers before sending OTP:

```ts
import { parsePhoneNumber } from "libphonenumber-js"

phoneNumber({
  sendOTP: async ({ phoneNumber, code }) => {
    // send SMS
  },
  phoneNumberValidator: async (phoneNumber) => {
    try {
      const parsed = parsePhoneNumber(phoneNumber)
      return parsed.isValid()
    } catch {
      return false
    }
  },
})
```

## Security Features

### Rate Limiting

Built-in rate limiting on phone endpoints (see index.ts:60-68):

```ts
rateLimit: [
  {
    pathMatcher(path) {
      return path.startsWith("/phone-number")
    },
    window: 60 * 1000, // 60 seconds
    max: 10,           // 10 requests
  },
]
```

### Protected Updates

Phone numbers cannot be updated via `/update-user` endpoint (see index.ts:36-44). Users must verify new numbers through the OTP flow.

### Attempt Limiting

OTP verification attempts are limited (default: 3). After max attempts, users must request a new code.

## Auto Sign-Up

Automatically create users on phone verification:

```ts
phoneNumber({
  sendOTP: async ({ phoneNumber, code }) => {
    // send SMS
  },
  signUpOnVerification: {
    getTempEmail: (phoneNumber) => {
      // Generate temporary email from phone
      return `${phoneNumber.replace(/\+/g, '')}@temp.myapp.com`
    },
    getTempName: (phoneNumber) => {
      // Use phone as temporary name
      return phoneNumber
    },
  },
})
```

When enabled:
- New users are created on successful verification
- Temporary email is generated using `getTempEmail`
- User can update email later
- Phone number is marked as verified

## Database Schema

User table is extended with phone number fields:

```ts
interface User {
  phoneNumber: string | null      // Phone number (unique)
  phoneNumberVerified: boolean    // Verification status
  // ... other fields
}
```

## Error Codes

Phone number plugin defines error codes:

- `PHONE_NUMBER_CANNOT_BE_UPDATED` - Cannot update phone via update-user endpoint
- `INVALID_PHONE_NUMBER` - Phone number format is invalid
- `OTP_EXPIRED` - OTP has expired
- `INVALID_OTP` - OTP is incorrect
- `TOO_MANY_ATTEMPTS` - Exceeded verification attempts
