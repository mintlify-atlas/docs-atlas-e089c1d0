---
title: Generic OAuth
description: Add OAuth support for any OAuth 2.0 provider
---

The Generic OAuth plugin enables you to integrate any OAuth 2.0 provider into your Better Auth setup. It provides a flexible configuration system that supports both standard OAuth flows and custom implementations.

## Use Cases

- Add OAuth support for providers not built into Better Auth
- Integrate with enterprise identity providers (Okta, Auth0, Microsoft Entra ID, Keycloak)
- Connect to niche platforms (Slack, Patreon, Gumroad, LINE)
- Implement custom OAuth flows with non-standard providers
- Support OIDC discovery for automatic endpoint configuration

## Installation

The Generic OAuth plugin is included in the Better Auth core package.

```bash
pnpm add better-auth
```

## Configuration

### Basic Setup

Add the plugin to your Better Auth configuration:

```ts title="auth.ts"
import { betterAuth } from "better-auth";
import { genericOAuth } from "better-auth/plugins";

export const auth = betterAuth({
  plugins: [
    genericOAuth({
      config: [
        {
          providerId: "my-provider",
          clientId: process.env.MY_PROVIDER_CLIENT_ID!,
          clientSecret: process.env.MY_PROVIDER_CLIENT_SECRET,
          discoveryUrl: "https://provider.com/.well-known/openid-configuration",
          scopes: ["openid", "email", "profile"],
        },
      ],
    }),
  ],
});
```

### Manual Endpoint Configuration

For providers without OIDC discovery support:

```ts
genericOAuth({
  config: [
    {
      providerId: "custom-provider",
      clientId: process.env.CLIENT_ID!,
      clientSecret: process.env.CLIENT_SECRET,
      authorizationUrl: "https://provider.com/oauth/authorize",
      tokenUrl: "https://provider.com/oauth/token",
      userInfoUrl: "https://provider.com/oauth/userinfo",
      scopes: ["email", "profile"],
    },
  ],
})
```

## Configuration Options

### Core Options

<Properties>
  <Property name="providerId" type="string" required>
    Unique identifier for the OAuth provider.
  </Property>
  <Property name="clientId" type="string" required>
    OAuth client ID from the provider.
  </Property>
  <Property name="clientSecret" type="string">
    OAuth client secret. Optional for public clients using PKCE.
  </Property>
  <Property name="discoveryUrl" type="string">
    URL to fetch OAuth 2.0 / OIDC configuration. If provided, authorization and token endpoints will be fetched automatically.
  </Property>
  <Property name="authorizationUrl" type="string">
    Authorization endpoint URL. Required if not using `discoveryUrl`.
  </Property>
  <Property name="tokenUrl" type="string">
    Token endpoint URL. Required if not using `discoveryUrl`.
  </Property>
  <Property name="userInfoUrl" type="string">
    User info endpoint URL. Optional if using `discoveryUrl`.
  </Property>
  <Property name="scopes" type="string[]" default="[]">
    OAuth scopes to request.
  </Property>
  <Property name="redirectURI" type="string">
    Custom redirect URI. If not provided, a default URI will be constructed.
  </Property>
  <Property name="pkce" type="boolean" default="false">
    Enable PKCE (Proof Key for Code Exchange) for enhanced security.
  </Property>
</Properties>

### Advanced Options

<Properties>
  <Property name="authentication" type="'basic' | 'post'" default="'post'">
    Authentication method for token requests.
  </Property>
  <Property name="responseType" type="string" default="'code'">
    OAuth response type.
  </Property>
  <Property name="responseMode" type="'query' | 'form_post'">
    Response mode for the authorization request.
  </Property>
  <Property name="prompt" type="string">
    Prompt parameter for the authorization request (e.g., `"login"`, `"consent"`, `"select_account"`).
  </Property>
  <Property name="accessType" type="string">
    Access type for the authorization request. Use `"offline"` to request a refresh token.
  </Property>
  <Property name="disableImplicitSignUp" type="boolean" default="false">
    Disable implicit sign up for new users. When true, sign-in must be called with `requestSignUp: true` to create new users.
  </Property>
  <Property name="disableSignUp" type="boolean" default="false">
    Completely disable sign up for new users.
  </Property>
  <Property name="overrideUserInfo" type="boolean" default="false">
    Override user info with the provider info when the user signs in.
  </Property>
</Properties>

## Pre-configured Providers

Better Auth includes pre-configured providers for common OAuth services:

```ts
import { 
  auth0,
  okta,
  microsoftEntraId,
  keycloak,
  slack,
  patreon,
  gumroad,
  hubspot,
  line
} from "better-auth/plugins";

genericOAuth({
  config: [
    auth0({
      clientId: process.env.AUTH0_CLIENT_ID!,
      clientSecret: process.env.AUTH0_CLIENT_SECRET!,
      domain: process.env.AUTH0_DOMAIN!,
    }),
    okta({
      clientId: process.env.OKTA_CLIENT_ID!,
      clientSecret: process.env.OKTA_CLIENT_SECRET!,
      issuer: process.env.OKTA_ISSUER!,
    }),
    microsoftEntraId({
      clientId: process.env.ENTRA_CLIENT_ID!,
      clientSecret: process.env.ENTRA_CLIENT_SECRET!,
      tenantId: process.env.ENTRA_TENANT_ID!,
    }),
  ],
})
```

## Custom Functions

### Custom Token Exchange

For providers with non-standard token endpoints:

```ts
genericOAuth({
  config: [
    {
      providerId: "custom",
      clientId: process.env.CLIENT_ID!,
      getToken: async ({ code, redirectURI, codeVerifier }) => {
        // Custom token exchange logic
        const response = await fetch("https://provider.com/token", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            code,
            redirect_uri: redirectURI,
            code_verifier: codeVerifier,
          }),
        });
        
        const data = await response.json();
        return {
          accessToken: data.access_token,
          refreshToken: data.refresh_token,
          accessTokenExpiresAt: new Date(Date.now() + data.expires_in * 1000),
          scopes: data.scope?.split(" "),
        };
      },
    },
  ],
})
```

### Custom User Info Fetching

```ts
genericOAuth({
  config: [
    {
      providerId: "custom",
      clientId: process.env.CLIENT_ID!,
      clientSecret: process.env.CLIENT_SECRET,
      getUserInfo: async (tokens) => {
        const response = await fetch("https://api.provider.com/user", {
          headers: {
            Authorization: `Bearer ${tokens.accessToken}`,
          },
        });
        
        const data = await response.json();
        return {
          id: data.userId,
          email: data.emailAddress,
          name: data.displayName,
          emailVerified: data.verified,
          image: data.avatarUrl,
        };
      },
    },
  ],
})
```

### Profile Mapping

Map provider-specific fields to Better Auth user fields:

```ts
genericOAuth({
  config: [
    {
      providerId: "custom",
      clientId: process.env.CLIENT_ID!,
      clientSecret: process.env.CLIENT_SECRET,
      authorizationUrl: "https://provider.com/oauth/authorize",
      tokenUrl: "https://provider.com/oauth/token",
      userInfoUrl: "https://provider.com/oauth/userinfo",
      mapProfileToUser: (profile) => {
        return {
          name: `${profile.firstName} ${profile.lastName}`,
          email: profile.primaryEmail,
          image: profile.profilePicture,
          // Map additional custom fields
          customField: profile.customData,
        };
      },
    },
  ],
})
```

## Usage

### Client-side Sign In

```ts title="client.ts"
import { createAuthClient } from "better-auth/client";
import { genericOAuthClient } from "better-auth/plugins/generic-oauth/client";

const authClient = createAuthClient({
  plugins: [genericOAuthClient()],
});

// Sign in with a configured provider
await authClient.signIn.oauth2({
  providerId: "my-provider",
  callbackURL: "/dashboard",
});
```

### Link Account

Link an OAuth account to an existing user:

```ts
await authClient.oauth2.link({
  providerId: "my-provider",
  callbackURL: "/profile",
});
```

### Request Additional Scopes

```ts
await authClient.signIn.oauth2({
  providerId: "my-provider",
  scopes: ["additional_scope"],
  callbackURL: "/dashboard",
});
```

## Security Considerations

### PKCE (Recommended)

Enable PKCE for all public clients and mobile applications:

```ts
genericOAuth({
  config: [
    {
      providerId: "my-provider",
      clientId: process.env.CLIENT_ID!,
      pkce: true, // Enable PKCE
      // clientSecret not required with PKCE
    },
  ],
})
```

### State Parameter

Better Auth automatically handles the `state` parameter for CSRF protection.

### Token Storage

Access tokens and refresh tokens are securely stored in the database and can be encrypted using the `account` configuration options.

### Disable Implicit Sign Up

Prevent automatic account creation:

```ts
genericOAuth({
  config: [
    {
      providerId: "my-provider",
      clientId: process.env.CLIENT_ID!,
      clientSecret: process.env.CLIENT_SECRET,
      disableImplicitSignUp: true,
    },
  ],
})

// Users must explicitly request sign up
await authClient.signIn.oauth2({
  providerId: "my-provider",
  requestSignUp: true,
});
```

### Custom Headers

Add custom headers for discovery or authorization requests:

```ts
genericOAuth({
  config: [
    {
      providerId: "my-provider",
      clientId: process.env.CLIENT_ID!,
      clientSecret: process.env.CLIENT_SECRET,
      discoveryHeaders: {
        "X-Custom-Header": "value",
      },
      authorizationHeaders: {
        "X-Auth-Header": "value",
      },
    },
  ],
})
```

## API Reference

### Endpoints

#### POST /sign-in/oauth2

Initiate OAuth sign-in flow.

**Server:** `auth.api.signInWithOAuth2`

**Client:** `authClient.signIn.oauth2`

#### GET /oauth2/callback/:providerId

OAuth callback endpoint (automatically handled).

**Server:** `auth.api.oAuth2Callback`

#### POST /oauth2/link

Link an OAuth account to the current user.

**Server:** `auth.api.oAuth2LinkAccount`

**Client:** `authClient.oauth2.link`

### Error Codes

The plugin defines the following error codes:

- `PROVIDER_CONFIG_NOT_FOUND`: The specified provider configuration was not found
- `INVALID_OAUTH_CONFIGURATION`: Invalid OAuth configuration (missing required fields)
- `TOKEN_URL_NOT_FOUND`: Token URL could not be determined
- `SESSION_REQUIRED`: Operation requires an active session

## Examples

### Okta Integration

```ts
import { okta } from "better-auth/plugins";

genericOAuth({
  config: [
    okta({
      clientId: process.env.OKTA_CLIENT_ID!,
      clientSecret: process.env.OKTA_CLIENT_SECRET!,
      issuer: "https://dev-123456.okta.com",
    }),
  ],
})
```

### Auth0 Integration

```ts
import { auth0 } from "better-auth/plugins";

genericOAuth({
  config: [
    auth0({
      clientId: process.env.AUTH0_CLIENT_ID!,
      clientSecret: process.env.AUTH0_CLIENT_SECRET!,
      domain: "your-tenant.auth0.com",
    }),
  ],
})
```

### Microsoft Entra ID (Azure AD)

```ts
import { microsoftEntraId } from "better-auth/plugins";

genericOAuth({
  config: [
    microsoftEntraId({
      clientId: process.env.ENTRA_CLIENT_ID!,
      clientSecret: process.env.ENTRA_CLIENT_SECRET!,
      tenantId: "common", // or specific tenant ID
    }),
  ],
})
```

## Related Plugins

- [OAuth Proxy](/plugins/oauth-proxy) - Proxy OAuth requests through your production server
- [SSO](/plugins/sso) - Enterprise SSO with SAML and OIDC
- [OIDC Provider](/plugins/oidc-provider) - Turn your app into an OAuth/OIDC provider
